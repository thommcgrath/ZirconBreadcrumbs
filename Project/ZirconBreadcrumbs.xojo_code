#tag Class
Protected Class ZirconBreadcrumbs
Inherits ArtisanKit.Control
	#tag Event
		Function MouseDown(X As Integer, Y As Integer) As Boolean
		  If Not Self.Registered Then
		    Return False
		  End If
		  
		  Self.mMouseDownPoint = New REALbasic.Point(X,Y)
		  Dim CellIndex As Integer = Self.CellIndexForPoint(Self.mMouseDownPoint)
		  If CellIndex = -1 Then
		    Return True
		  End If
		  
		  Self.mMouseDownIndex = CellIndex
		  Self.mMouseDown = True
		  Self.Invalidate
		  Self.mHoldTimer = New Timer
		  Self.mHoldTimer.Period = 750
		  Self.mHoldTimer.Mode = Timer.ModeSingle
		  AddHandler mHoldTimer.Action, AddressOf HoldTimerAction
		  Return True
		End Function
	#tag EndEvent

	#tag Event
		Sub MouseDrag(X As Integer, Y As Integer)
		  If Not Self.mMouseDown Then
		    Return
		  End If
		  
		  If X < Self.mMouseDownPoint.X -5 Or X > Self.mMouseDownPoint.X + 5 Or Y < Self.mMouseDownPoint.Y - 5 Or Y > Self.mMouseDownPoint.Y + 5 Then
		    If Self.mHoldTimer <> Nil Then
		      RemoveHandler mHoldTimer.Action, AddressOf HoldTimerAction
		      Self.mHoldTimer.Mode = Timer.ModeOff
		      Self.mHoldTimer = Nil
		    End If
		    Self.mMouseDown = False
		    Self.Invalidate
		  End If
		End Sub
	#tag EndEvent

	#tag Event
		Sub MouseUp(X As Integer, Y As Integer)
		  If Not Self.mMouseDown Then
		    Return
		  End If
		  
		  If Self.mHoldTimer <> Nil Then
		    RemoveHandler mHoldTimer.Action, AddressOf HoldTimerAction
		    Self.mHoldTimer.Mode = Timer.ModeOff
		    Self.mHoldTimer = Nil
		  End If
		  
		  Self.mMouseDown = False
		  Self.mMouseDownPoint = Nil
		  Dim CellIndex As Integer = Self.CellIndexForPoint(New REALbasic.Point(X,Y))
		  If Self.mMouseDownIndex = CellIndex Then
		    Self.Value = CellIndex
		  End If
		  Self.Invalidate
		End Sub
	#tag EndEvent

	#tag Event
		Sub Open()
		  Self.AddCells("Home")
		  RaiseEvent Open
		End Sub
	#tag EndEvent

	#tag Event
		Sub Paint(G As Graphics, Areas() As REALbasic.Rect, ScalingFactor As Double, Highlighted As Boolean)
		  #pragma Unused Areas
		  #pragma Unused Highlighted
		  
		  If Not Self.Registered Then
		    Return
		  End If
		  
		  Const CellPadding = 4
		  
		  If Self.mSprites = Nil Or Self.mSprites.Lookup("ScalingFactor",0) <> ScalingFactor Then
		    Dim Sheet As Picture = Self.GetSpriteSheet(ScalingFactor)
		    Self.mSprites = New Dictionary
		    Self.mSprites.Value("ScalingFactor") = ScalingFactor
		    Self.mSprites.Value("DividerAlternateToAlternate")        = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  0,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("FillAlternate")                      = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  1,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("CapAlternate")                       = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  2,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerAlternateToPrimary")          = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  3,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("FillPrimary")                        = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  4,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("CapPrimary")                         = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  5,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerPrimaryToAlternate")          = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  6,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerAlternateToAlternatePressed") = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  7,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("FillAlternatePressed")               = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  8,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerAlternatePressedToAlternate") = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth *  9,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("CapAlternatePressed")                = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth * 10,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerAlternateToPrimaryPressed")   = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth * 11,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("FillPrimaryPressed")                 = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth * 12,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerPrimaryPressedToAlternate")   = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth * 13,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("CapPrimaryPressed")                  = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth * 14,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerAlternatePressedToPrimary")   = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth * 15,0,SpriteWidth,SpriteHeight))
		    Self.mSprites.Value("DividerPrimaryToAlternatePressed")   = Self.GrabSprite(Sheet, ScalingFactor, New REALbasic.Rect(SpriteWidth * 16,0,SpriteWidth,SpriteHeight))
		  End If
		  
		  Dim TopPosition As Integer = 0
		  If Self.BorderPosition = BorderTop Then
		    TopPosition = 1
		  End If
		  
		  Dim Fill As Picture = Self.mSprites.Value("FillAlternate")
		  G.FillWithPattern(Fill,New REALbasic.Rect(0,TopPosition,G.Width,SpriteHeight))
		  
		  If UBound(Self.mCells) > -1 Then
		    Dim Rects() As REALbasic.Rect
		    Dim NextLeft As Integer = 0
		    Redim Rects(UBound(Self.mCells))
		    For I As Integer = 0 To UBound(Self.mCells)
		      Dim W As Integer = Ceil(G.StringWidth(Self.mCells(I))) + (CellPadding * 2)
		      If Self.mCellIcons(I) <> Nil Then
		        If Self.mCells(I) <> "" Then
		          W = W + IconWidth + CellPadding
		        Else
		          W = W + IconWidth
		        End If
		      End If
		      If I  = 0 Or I = UBound(Self.mCells) Then
		        W = W + CellPadding
		      End If
		      Rects(I) = New REALbasic.Rect(NextLeft,TopPosition,W,SpriteHeight)
		      NextLeft = NextLeft + W + SpriteWidth
		    Next
		    Dim DesiredWidth As Integer = NextLeft
		    
		    Dim AbsoluteMinimum As Integer = (Self.CellCount * (IconWidth + (CellPadding * 2) + SpriteWidth)) + (CellPadding * 2)
		    If G.Width <= AbsoluteMinimum Then
		      // Collapse Everything
		      NextLeft = 0
		      For I As Integer = 0 To UBound(Rects)
		        Rects(I).Left = NextLeft
		        Rects(I).Width = IconWidth + (CellPadding * 2)
		        If I  = 0 Or I = UBound(Self.mCells) Then
		          Rects(I).Width = Rects(I).Width + CellPadding
		        End If
		        NextLeft = Rects(I).Right + SpriteWidth
		      Next
		    ElseIf G.Width <= DesiredWidth Then
		      // Dynamic Scaling
		      Dim Groups() As Collection
		      If UBound(Self.mCells) > 2 Then
		        Dim Inner As New Collection
		        For I As Integer = 1 To UBound(Self.mCells) - 2
		          Inner.Add(I)
		        Next
		        Groups.Append(Inner)
		      End If
		      Dim RootGroup As New Collection
		      RootGroup.Add(0)
		      Groups.Append(RootGroup)
		      If UBound(Self.mCells) > 0 Then
		        Dim Group As New Collection
		        Group.Add(UBound(Self.mCells) - 1)
		        Groups.Append(Group)
		      End If
		      If UBound(Self.mCells) > 1 Then
		        Dim Group As New Collection
		        Group.Add(UBound(Self.mCells))
		        Groups.Append(Group)
		      End If
		      Do
		        For Each Group As Collection In Groups
		          Dim Count As Integer = Group.Count
		          Dim GroupWasSized As Boolean = False
		          For I As Integer = 1 To Count
		            Dim Index As Integer = Group.Item(I)
		            Dim MinWidth As Integer = IconWidth + (CellPadding * 2)
		            If Index = 0 Or Index = UBound(Self.mCells) Then
		              MinWidth = MinWidth + CellPadding
		            End If
		            If Rects(Index).Width > MinWidth Then
		              Rects(Index).Width = Rects(Index).Width - 1
		              DesiredWidth = DesiredWidth - 1
		              GroupWasSized = True
		              If DesiredWidth <= G.Width Then
		                Exit Do
		              End If
		            End If
		          Next
		          If DesiredWidth > G.Width And GroupWasSized Then
		            Continue Do
		          End If
		        Next
		      Loop
		      NextLeft = 0
		      For I As Integer = 0 To UBound(Rects)
		        Rects(I).Left = NextLeft
		        NextLeft = Rects(I).Right + SpriteWidth
		      Next
		    Else
		      // Everything Fits Nicely
		    End If
		    
		    For I As Integer = 0 To UBound(Self.mCells)
		      Dim Rect As REALbasic.Rect = Rects(I)
		      Dim CellCaption As String = Self.mCells(I)
		      Dim CellIcon As ArtisanKit.RetinaPicture = Self.mCellIcons(I)
		      Dim IsPressed As Boolean = Self.mMouseDown And Self.mMouseDownIndex = I
		      Dim IsNextPressed As Boolean = Self.mMouseDown And Self.mMouseDownIndex = I + 1
		      
		      Dim Cap As Picture
		      If Self.Value = I Then
		        If IsPressed Then
		          Fill = Self.mSprites.Value("FillPrimaryPressed")
		        Else
		          Fill = Self.mSprites.Value("FillPrimary")
		        End If
		        If I = UBound(Self.mCells) Then
		          If IsPressed Then
		            Cap = Self.mSprites.Value("CapPrimaryPressed")
		          Else
		            Cap = Self.mSprites.Value("CapPrimary")
		          End If
		        Else
		          If IsPressed Then
		            Cap = Self.mSprites.Value("DividerPrimaryPressedToAlternate")
		          ElseIf IsNextPressed Then
		            Cap = Self.mSprites.Value("DividerPrimaryToAlternatePressed")
		          Else
		            Cap = Self.mSprites.Value("DividerPrimaryToAlternate")
		          End If
		        End If
		      Else
		        If IsPressed Then
		          Fill = Self.mSprites.Value("FillAlternatePressed")
		        Else
		          Fill = Self.mSprites.Value("FillAlternate")
		        End If
		        If I = UBound(Self.mCells) Then
		          If IsPressed Then
		            Cap = Self.mSprites.Value("CapAlternatePressed")
		          Else
		            Cap = Self.mSprites.Value("CapAlternate")
		          End If
		        Else
		          If Self.Value = I + 1 Then
		            If IsPressed Then
		              Cap = Self.mSprites.Value("DividerAlternatePressedToPrimary")
		            ElseIf IsNextPressed Then
		              Cap = Self.mSprites.Value("DividerAlternateToPrimaryPressed")
		            Else
		              Cap = Self.mSprites.Value("DividerAlternateToPrimary")
		            End If
		          Else
		            If IsPressed Then
		              Cap = Self.mSprites.Value("DividerAlternatePressedToAlternate")
		            ElseIf IsNextPressed Then
		              Cap = Self.mSprites.Value("DividerAlternateToAlternatePressed")
		            Else
		              Cap = Self.mSprites.Value("DividerAlternateToAlternate")
		            End If
		          End If
		        End If
		      End If
		      
		      G.DrawPicture(Cap,Rect.Right,TopPosition,SpriteWidth,SpriteHeight,0,0,Cap.Width,Cap.Height)
		      G.FillWithPattern(Fill,Rect)
		      
		      Dim TextLeft As Integer = Rect.Left + CellPadding
		      Dim TextSpace As Integer = Rect.Width - (CellPadding * 2)
		      If I = 0 Then
		        TextLeft = TextLeft + CellPadding
		      End If
		      Dim TextColor, ShadowColor As Color
		      If Self.Value = I Then
		        TextColor = Self.PrimaryTextColor
		        ShadowColor = Self.PrimaryTextShadowColor
		      Else
		        TextColor = Self.AlternateTextColor
		        ShadowColor = Self.AlternateTextShadowColor
		      End If
		      If Self.mMouseDown And Self.mMouseDownIndex = I Then
		        TextColor = ArtisanKit.BlendColors(TextColor,&c000000,0.25)
		        ShadowColor = ArtisanKit.BlendColors(ShadowColor,&c000000,0.25)
		      End If
		      If CellIcon <> Nil Then
		        Dim IconRect As New REALbasic.Rect(TextLeft,Rect.VerticalCenter - (IconHeight / 2),IconWidth,IconHeight)
		        TextLeft = TextLeft + IconWidth + CellPadding
		        TextSpace = TextSpace - (IconWidth + CellPadding)
		        Select Case Me.CellIconType(I)
		        Case IconTypeTemplate
		          Dim Mask As Picture
		          If ScalingFactor > 1 Then
		            Mask = CellIcon.HiRes
		          Else
		            Mask = CellIcon
		          End If
		          Dim Icon As New Picture(IconWidth * ScalingFactor, IconHeight * ScalingFactor, 32)
		          Icon.Mask.Graphics.ClearRect(0,0,Icon.Width,Icon.Height)
		          Icon.Mask.Graphics.DrawPicture(Mask,0,0,Icon.Width,Icon.Height,0,0,Mask.Width,Mask.Height)
		          Icon.Graphics.ForeColor = ShadowColor
		          Icon.Graphics.FillRect(0,0,Icon.Width,Icon.Height)
		          G.DrawPicture(Icon,IconRect.Left,IconRect.Top + 1,IconRect.Width,IconRect.Height,0,0,Icon.Width,Icon.Height)
		          Icon.Graphics.ForeColor = TextColor
		          Icon.Graphics.FillRect(0,0,Icon.Width,Icon.Height)
		          G.DrawPicture(Icon,IconRect.Left,IconRect.Top,IconRect.Width,IconRect.Height,0,0,Icon.Width,Icon.Height)
		        Else
		          G.DrawRetinaPicture(CellIcon,IconRect.Left,IconRect.Top,IconRect.Width,IconRect.Height,0,0,CellIcon.Width,CellIcon.Height)
		        End Select
		      End If
		      If TextSpace > CellPadding Then
		        Dim TextTop As Integer = Rect.VerticalCenter + (G.CapHeight / 2)
		        G.ForeColor = ShadowColor
		        G.DrawString(CellCaption,TextLeft,TextTop + 1,TextSpace,True)
		        G.ForeColor = TextColor
		        G.DrawString(CellCaption,TextLeft,TextTop,TextSpace,True)
		      End If
		    Next
		    mCellRects = Rects
		  Else
		    Redim mCellRects(-1)
		  End If
		  
		  Select Case Self.BorderPosition
		  Case BorderNone
		    // Do Nothing
		  Case BorderTop
		    G.ForeColor = Self.BorderColor
		    G.DrawLine(-1,0,G.Width + 1,0)
		  Case BorderBottom
		    G.ForeColor = Self.BorderColor
		    G.DrawLine(-1,22,G.Width + 1,22)
		  End Select
		End Sub
	#tag EndEvent


	#tag Method, Flags = &h0
		Sub AddCells(ParamArray Cells() As String)
		  For Each Cell As String In Cells
		    Self.mCells.Append(Cell)
		    Self.mCellIcons.Append(Nil)
		    Self.mCellIconTypes.Append(IconTypeFullColor)
		  Next
		  Self.Invalidate
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Function Cell(Index As Integer) As String
		  Return Self.mCells(Index)
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Cell(Index As Integer, Assigns NewValue As String)
		  Self.mCells(Index) = NewValue
		  Self.Invalidate
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Function CellIcon(Index As Integer) As ArtisanKit.RetinaPicture
		  Return Self.mCellIcons(Index)
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub CellIcon(Index As Integer, Assigns NewValue As ArtisanKit.RetinaPicture)
		  Self.mCellIcons(Index) = NewValue
		  Self.Invalidate
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Function CellIconType(Index As Integer) As Integer
		  Return Self.mCellIconTypes(Index)
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub CellIconType(Index As Integer, Assigns NewValue As Integer)
		  Self.mCellIconTypes(Index) = NewValue
		  Self.Invalidate
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function CellIndexForPoint(Point As REALbasic.Point) As Integer
		  For I As Integer = 0 To UBound(mCellRects)
		    If mCellRects(I).Contains(Point) Then
		      Return I
		    End If
		  Next
		  Return -1
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub DeleteAllCells()
		  Self.CellCount = 0
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function GetImage(ImageNamed As String) As Picture
		  Static Images As Dictionary
		  If Images = Nil Then
		    Images = New Dictionary
		    
		    Const ImagesBinary = "89504E470D0A1A0A0000000D49484452000000CC00000016080200000003E5E4EC00000424694343504943432050726F66696C65000038118555DF6FDB54143E896F52A4163F205847878AC5AF55535BB91B1AADC6064993A5ED4A16A5E9D82A24E43A3789A91B07DBE9B6AA4F7B813706FC0140D9030F483C210D06627BD9F6C0B44953872AAA49487BE8C40F2126ED0555E1BB76622753C45CF5FACB39DF39E73BE75EDB443D5F69B59A19558896ABAE9DCF249593A716949E4D8AD2B3D44B03D4ABE94E2D91CBCD122EC115F7CEEBE11D8A08CBED91EEFE4EF623BF7A8BDCD189224FC06E151D7D19F80C51CCD46BB64B14BF07FBF869B706DCF31CF0D3360402AB02977D9C1278D1C7273D4E213F098ED02AEB15AD08BC063CBCD8662FB7615F0318C893E1556E1BBA226691B3AD926172CFE12F8F71B731FF0F2E9B75F4EC5D8358FB9CA5B963B80F89DE2BF654BE893FD7B5F41CF04BB05FAFB949617F05F88FFAD27C02781F51F4A9927D74DEE7475F5FAD14DE06DE057BD170A70B4DFB6A75317B1C18B1D1F525EB98C82338D7756712B3A41780EF56F8B4D863E891A8C85369E061E0C14A7DAA995F9A7156E684DDCBB35A99CC02238F64BFA7CDE48007803FB4ADBCA805CDD23A3733A216F24B576B6EAEA941DAAE9A59510BFD32993B5E8FC8296DBB95C2941FCB0EBA76A119CB164AC6D1E9267FAD667A6711DAD805BB9E17DA909FDDD2EC74061879D83FBC3A2FE6061CDB5DD45262B6A3C047E84444234E162D62D5A94A3BA4509E3294C4BD46363C2532C88485C3CB6131224FD2126CDD79398FE3C7848CB217BD2DA251A53BC7AF70BFC9B1583F53D901FC1F62B3EC301B6713A4B037D89BEC084BC13AC10E050A726D3A152AD37D28F5F3BC4F7554163A4E50F2FC407D288851CED9EF1AFACD8FFE869AB04B2BF4234FD031345BED13200713687537D23EA76B6B3FEC0E3CCA06BBF8CEEDBE6B6B74FC71F38DDD8B6DC736B06EC6B6C2F8D8AFB12DFC6D52023B607A8A96A1CAF076C20978231D3D5C01D3250DEB6FE059D0DA52DAB1A3A5EAF981D02326C13FC83ECCD2B9E1D0AAFEA2FEA96EA85FA817D4DF3B6A84193BA6247D2A7D2BFD287D277D2FFD4C8A7459BA22FD245D95BE912E0539BBEFBD9F25D87BAF5F6113DD8A5D68D56B9F3527534ECA7BE417E594FCBCFCB23C1BB014B95F1E93A7E4BDF0EC09F6CD0CFD1DBD18740AB36A4DB57B2DF10418340F25069D06D7C654C584AB741659DB9F93A65236C8C6D8F423A7765C9CE5968A783A9E8A274889EF8B4FC4C7E23302B79EBCF85EF826B0A603F5FE9313303A3AE06D2C4C25C833E29D3A715645F40A749BD0CD5D7E06DF0EA249AB76D636CA1557D9AFAAAF29097CCAB8325DD5478715CD3415CFE5283677B8BDC28BA324BE83228EE841DEFBBE4576DD0C6DEE5B4487FFC23BEB56685BA8137DED10F5BF1ADA86F04E7CE633A28B07F5BABDE2E7A348E40691533AB0DFFB1DE94BE2DD74B7D17880F755CF27443B1F371AFFAE371A3B5F22FF16D165F33F590071786C1B2B13000000097048597300000B1300000B1301009A9C1800000DC8494441546805AD5B59505BD71996AE562404129B0461332406CC626CC06C31212636264E6AE3D493A9D37DDAA73EB43379491FFAD8974EFD92BEB4D3CE74D28E67D24CA6756A430C4E93D838016C02788B0107B1D902210162D18216D4EFEA88CBE56E48C277EE5CCE3DCBFFFFDFF79FF3DFFF9E2BE4D7AE5D2B2C2C2C2F2F973DBFE3D2A54BEFBEFB2E5FDEEFFEDEA5B314CA2DE50B5E7E638235A31F5EFAF27D015D9D97BA5E39A0FFCDF95609B95D5D5DA3A3A3B9B9B9A9A9A972B95CA2A774D3C4C4445D5D5D6BAB94AE4F3EF98408B1DBEDEBEBEB62FC7C39389A9C95ABD6A7CAF6618F6B76A2F3449D34F6B37FA0EDF12E2FF83D1B8204A2F5E26FFF58D9D221EDAF99FEAEECCD995387722408545655555DB972253B3BDB643211169ED7351C0E7344751EAF7AEFCF577EF0438B8B3279839CC67DDDF275E5D6B47DDA7B393FCBD4D95C25261AD81F3F7E8CD6ACAC2C9D4E27D66DCFFA402070F7EEDDB4B4B4CACA4AB1CE050505A409A66292A1CCB719FCDC1AA6ED493265293589DB130AF8FFF3F95D69EC06336D0F6CC02413340695F52F6677FDEF73697F81E789DECBD60DD9898A28400CE41C544E4E4E7D7D7D7777772814DA7A4E0774C07ABEB0C30772DE69AFFFF45A77B9694B4E77790E87982EB9429557DFF1A78F3F9F73AEF22D2135C0DED2D2B2B8B888E8E2F7FB13B6C662B16086F5F6F6AEAE8AEA620B17B319FCFCFC7B2D9EE545CF921D13853D24AEB22E2D5B63487BFFA31B12D88940D9161D085016A4A8A6A4E0508642DA5F84E7AB4353B6A535312329483F72E488D96CEEEBEB833E4165F156428E98A88BAD476A5FB40CF7F715A78665E1ADE7708AD80CC93A53A6F950FDE5CF06C54824D8ABABABAD56EBF2F272301814A349BA5EA3D1E4E7E72B954AC43331E06C09117A84A9063F675EAE5E9BB76EAE2F8743C1C4F851AA3506739E9C524860DF964C4F3231FF02D7999A97743E87B4BF08CF3D23936204520860381A1A1A868787A7A7A7C105A9D9CF95D82D26E1971D0D23C3C321C7749A066B686B9F277409DA4CC46696D47C35B9FAD7EE7EC13EC442608790C9C9493CC5409398D912F5186E301890DA8E8C8CF4F74BE9821078744F7ED061CD660DF8361061B016E33D65945CA54F35E4145DFFEABE18F6A84C79349209A223B8CE1C39B0A7BFC0F3A44F7FE5CE134102E9488643A150B4B7B723E0FB7C3E7ACD01DB3E4E18878348E65F352AC57BEF9CEAE9ED2DD27A5488D7FB5084B15014B197AB87119B7BB4EDDFB71FDCBC3FC9EDB17D4FB07B3C9EA773733E8F871918578192CBD38C468BD98C4966B55AF92631D2C04B849E3DF80978DD6EFB5CC8EF9185B61238614F92C1A84F337FD83B20887D47A60881A00736438E39DD74A238654F7F81E73B33AEA1EF6C0C52A6108D6498C8C84C4B4B4BAF5FBFAE5428B6B0E0F67112C70B2E0E52D97CA8F0F56365376EF494A7CB655BA1F03E4E315D8C4C85469353DDFAFB7F74FBC58314B0D7D6D62ED8ED0EA713C95962D8952A55B6C592A4D5E2A5151EE2C06764229489D9CC0C013FDF3F51EB5E5EF0B89CA12092B3500227A550E9D22D4A759220F6A840999431C466E06A2CCD2FD006A4FD4578FE686072C3E365C09242349291557DF4E851BD5EFFCDF030A550808B844FE9954A74FDB8EDE84B99FAC987C379291433E51328401711C8B9B245E93373D38B2AFED2354051BBF0B287003BF671A6A6A791BC633626F0148725493A5D5E5E1EC4229E2140B2E5330211E462E4A7ADAE7CDD36B5B9BE0A5725925684650A8D2ED99C072AF8D819816204D2C647720E82ABA3BA40BE3C2BED2FC2F37F87AC1C027722195946151515030303CEA5253081AE899D300B5432EB52AC70BEB9627060D0E0731854203198D829A68B232DF360CD97DF3EFBD7AD7B1286013BA4619E6DB8DD009EC01A0369869414BCB422C1BD7FFF3EA4ED60672D5A319B773A474AE0073D3716A782747216482098C10FEA644372564EF7ED110E76469A9431DB36135C0DC5997BFA0B3C8FAF51371ECCB209A438914DAFD31DABABEBE9E9C1DE1A3FB1D8B534C56F60370E8E64FEAD2555F7B3D3C7AEF7DE2835CA1448CE103EE23FA188B693F770E78842B7ECC32D976F0C3D7EEAE0772635C0DED4D888E46C7E7E7E737393E3F2186F112CD3D3D3F11E70FBF6ED25AC55B014B18D190E6B697662E3E717671A0330C8391FF26F3209405C05B99CD218D2557AC307DD5FB3B11321244114241066B30FE02A7AC15C6D5649FB0BB8C0F3EDEF96266CCBCC708A1FAB8A8A8BB1166FDEBCA955AB4378DB8AFF8426D8CD97CCAF79ADBAB8A934E7EBBE5B25E9AAED65135F0411D3C597A6D4EA334B6BAF0E7C8B24836F09A90176C433A7D3E9DE88BCD925F452A256A9CC5959C140E0D1A3476A8D8648661EDF709E98CD7CABC04F4753053233BFCF9370E24A29D44946333644D8D8A3D2B6F7C9F8AA51C3D84C0AC0D57C30DB145A96F617E1F9CEA49D19AE2498019B7D90D546679BDBAF42ECD698CA91151C4B4F3AA98D3C5D118F62E9CFEF434205A73E1CA63835B8450C61562DBF95D4A003DD671FD8319CF61074D1590D1D65219961325A88871FDA30B2A7484C8CF74A131CA2916F87FCA840FA0FCDB92081A8676CA63B46A8032EBAB097BF68EC50B93D7994886911093B9729ABD566B35DB87001FB46A062A7219E1286F125F3057C76DFDA3F613B7BEEDCDD79EC1D449F23FC6ED235E08EAF0B0EE68C0A78371C6343BFFAD149AFC703E7735AC92DB03F7CF8105FD8D488E23C660487F02BB10D844F08D89B3D545EBE8E6F00115D8C344269ECFC5C1F7CA849312A542A4C5DBEAE586A4208832B0B72A5B2A3B684C11E9586C917993D8C796C819C4AE0EA7F32BF4299CE36364BF88BF0DC5A6D61862B99E946A4BBDDEEE1D1D1CECE4E0F92DF4080AD32AE32ED789E9B3912EC2EF73F3F1B397FF68D878ECD40803BD7399D256E05A34E38B4EB8337CCB13FE87FBBB5FA4046724064F600FB9DA121B552999991A1A0E8775E09A5624DD88D743A1C1075FCF8F1A4A4247CD6243D196960063531F2F341CF10A5546953B2E47265628B702B14F0BA9C418FFBE2E9263676228D5C0509A48D6431005C53CFECF71C5BE7CFB64AF88BF0DC506028CC4866862B9172B1F91A1F1BC30F0AB45A2D9212767D02658E64BE84AB83D0756445A65F75FBF8ADB1D7D04F9EDD283036BCB5EB71B9647DD0526679A3A6D8E715FD0508B0634EE4E4E7ABE8B0411FB1DB407AC212D7CA0A3E861EADA979B1B87883C521F34C60A8E7DBCC51077EB68281647301A552D2C6C46F0F5CEE5F777997164FBF7C98839D98119D644204C218C666826B68D65557774CDA5FE0F9807EB3A92837C25F944025230842C7C7C7FD81405959195E8B3880E3BD850EB664FEF07F0F8C4DB9FC2F1F2EBB3BBB1EB733778B13D4C54EF0BC2BF6D5A7DF5D7CFB02C2F3EEA13B77C03E363E9E999989BD2ED8B36718DE19B95D025EBC083E9B9F47B28FEFA16BABABDB2DF45F466034AD89819F5BA3135A53A632F2F3104C17B6B498CAE170C0E7713B6D945A7DF17805073B11B87D157616B199E0FA62C21E36E515164BF92BCA73CB010E813B39D9C2C2C2ECDCDC5B6FBD8519C63C4D630223D24942C89075E18B477378507EF3740DFB16220262ADC624E3EB8213C978BCFC3B9F8CFCFA7C4B60D3C7EF46FA00FBB78F1FE3D73EF86119D9B08D5537AB1F763D10C3B0F573F2E449CC308E2E66C9C1DAA861224F6DB4829FEE3B638A24AD5A9F12D94B4AE4C10DE09E15BB4C2617C44EF8D9BE0A10083388CDC03532657F16D09D3FDE24E12FC2F3A9B20CAD8ADE856611238B46323C71B1D1DFD1D18164824923D8FDE22D0B461722643310FC5BCFF0EBED6DE3CEA0CFBFEB611DAF16D25F505738147D5C3A2746CFD49554BE60C4F72241F9043BE644464606B2750E418243F895188EC509F61A1B1B93F57AE4C89C3E8C585210B4990C21FCE08D4F9FF20245A9124BC5F04EBBB9B68C54ECFCAB7582D8A3395964C68B19035381CBEE58BAB3107ABDBD55DA5FE0B93C53596A3630481906A2916C627C1CBFE0331A8D2B4BCB4CDB3E0B9CA5CC48FB7860BCB2BC2CA83539E6E9DFEEEDFF205C70E41012D7E6A7EA8B4C9D75C5EBACF488D313D8BD5E2FBE6DE3B32379CFE774D8F3164E42E8C224ABA9A92939785030D960523126B592E027B4E9D5A559142ADA1E19BD1912DF017B029E55DF8AB3ADB14A143BBEBBE388081724108D9862C03538B756595E29ED2FF09CA3586B29CE1624905EB83333336EAFF795575F5D989F877DF10112E90DB138F88D37EECF8CD9DD6DAF350C4EB99E932A1A175F1784FBDD6B48C5CEB49F5E5D5BE35B426A80FDC9E4646A4A4A7272326A12838F7D01FBE222DE96CA4A4AB0912B2884A92485083DC2FCF4DD9B54E952954989DB13DAF47896ED0A8D16BF0613C34ECC60AE7C02C106700D4C2D7993B29A2A2A24FC4578EEA8CE142350891FEB4DCFCC749E3BB7B860175B5BC41FF15EF1819D336472D1D5333A73EECDF67B4FD7F10189D39AF02D98E2EBC22A5CB63EF8C9A91A4DD88FEF3A82C25DABAEF189096C75988C46A46209C377381CC89CB067B1E1F1E073AFA02E4638E34EBECDE0E7EA9D09194569538D7285221CD9291594265DE95975C29E9F9E3E26819D080F6FFF9E8C6F0C548C3D734C79B4E7DE6C92F017BE1183E7A6C264934EC560E498A77C66B335353521B9134B59380362BD85E3B7536F6648DFB8ADB9A166767DCBED134E8F989EF1158474AD4C8F9FA8CAAF3F9081373E3169C0EE585C4C4949A16709B56BCB436C8860FD7A2415C32FB0396F94ECCED8DF26B778981AF1EF144236831FAFCBA1D1A7E08A849D3D3CAE72D0B37EE6951A69EC6EC753C844DEA64E360A1A83D6272BC1E68606697FAD4C8F59A8D58C2D95CD26BAE7F57F4C062C4850EDEEA20000000049454E44AE42608289504E470D0A1A0A0000000D49484452000001980000002C0802000000D77539D500000424694343504943432050726F66696C65000038118555DF6FDB54143E896F52A4163F205847878AC5AF55535BB91B1AADC6064993A5ED4A16A5E9D82A24E43A3789A91B07DBE9B6AA4F7B813706FC0140D9030F483C210D06627BD9F6C0B44953872AAA49487BE8C40F2126ED0555E1BB76622753C45CF5FACB39DF39E73BE75EDB443D5F69B59A19558896ABAE9DCF249593A716949E4D8AD2B3D44B03D4ABE94E2D91CBCD122EC115F7CEEBE11D8A08CBED91EEFE4EF623BF7A8BDCD189224FC06E151D7D19F80C51CCD46BB64B14BF07FBF869B706DCF31CF0D3360402AB02977D9C1278D1C7273D4E213F098ED02AEB15AD08BC063CBCD8662FB7615F0318C893E1556E1BBA226691B3AD926172CFE12F8F71B731FF0F2E9B75F4EC5D8358FB9CA5B963B80F89DE2BF654BE893FD7B5F41CF04BB05FAFB949617F05F88FFAD27C02781F51F4A9927D74DEE7475F5FAD14DE06DE057BD170A70B4DFB6A75317B1C18B1D1F525EB98C82338D7756712B3A41780EF56F8B4D863E891A8C85369E061E0C14A7DAA995F9A7156E684DDCBB35A99CC02238F64BFA7CDE48007803FB4ADBCA805CDD23A3733A216F24B576B6EAEA941DAAE9A59510BFD32993B5E8FC8296DBB95C2941FCB0EBA76A119CB164AC6D1E9267FAD667A6711DAD805BB9E17DA909FDDD2EC74061879D83FBC3A2FE6061CDB5DD45262B6A3C047E84444234E162D62D5A94A3BA4509E3294C4BD46363C2532C88485C3CB6131224FD2126CDD79398FE3C7848CB217BD2DA251A53BC7AF70BFC9B1583F53D901FC1F62B3EC301B6713A4B037D89BEC084BC13AC10E050A726D3A152AD37D28F5F3BC4F7554163A4E50F2FC407D288851CED9EF1AFACD8FFE869AB04B2BF4234FD031345BED13200713687537D23EA76B6B3FEC0E3CCA06BBF8CEEDBE6B6B74FC71F38DDD8B6DC736B06EC6B6C2F8D8AFB12DFC6D52023B607A8A96A1CAF076C20978231D3D5C01D3250DEB6FE059D0DA52DAB1A3A5EAF981D02326C13FC83ECCD2B9E1D0AAFEA2FEA96EA85FA817D4DF3B6A84193BA6247D2A7D2BFD287D277D2FFD4C8A7459BA22FD245D95BE912E0539BBEFBD9F25D87BAF5F6113DD8A5D68D56B9F3527534ECA7BE417E594FCBCFCB23C1BB014B95F1E93A7E4BDF0EC09F6CD0CFD1DBD18740AB36A4DB57B2DF10418340F25069D06D7C654C584AB741659DB9F93A65236C8C6D8F423A7765C9CE5968A783A9E8A274889EF8B4FC4C7E23302B79EBCF85EF826B0A603F5FE9313303A3AE06D2C4C25C833E29D3A715645F40A749BD0CD5D7E06DF0EA249AB76D636CA1557D9AFAAAF29097CCAB8325DD5478715CD3415CFE5283677B8BDC28BA324BE83228EE841DEFBBE4576DD0C6DEE5B4487FFC23BEB56685BA8137DED10F5BF1ADA86F04E7CE633A28B07F5BABDE2E7A348E40691533AB0DFFB1DE94BE2DD74B7D17880F755CF27443B1F371AFFAE371A3B5F22FF16D165F33F590071786C1B2B130000000970485973000016250000162501495224F000002531494441547801DD9D698C5DC79598FBADFD96DED864934D7673DF499194286E224571A7A899D881114488AC64260106080671269368C630623B7F82FC0812E5C70041806002C3C1184E9CCC8C311635964C528B6549244D8AABB8B39BDDEC7D7BFDF6BDF3D5ADEEDB976FEBBAF7BE7ECDC955EBF1BE7A75ABCE56A7CE3975AAAEE3BDF7DEBB7BF7EE993367B66FDF5EF71C5FEFBEFB2ED0BDF3CE3B8A30FEF047677FFDD5DDD7DF38B3F385ED3747EB06138ACFD5BADAB5FF25F0FAF8CF54F1FAD6BB67279EDCDDB971E59FFDCB37EDC07AF6EC59F81E0A85BC5E6F535393DFEFF7783C4EA7D34E9B769E1D1A1A72B95C2B57AE7CF34D5B78FDF8C73F368291CD66E3F1782412A9AFAFA7DCACFCA4222197C7EB0D34B97D3E97DB5BB770F4898F0F399C2EFB7C7FE3DF4DD3270F6992F14C3CE2F40ACAA84BA024EF5BDFFBCF037187FDF1F5E40B21CF4B028ED3EB1AEC48A07BC58A1508F4850B17962F5FDEDADA5A3735659483E7F37E4A01C81DEB57A0C83E3A7FA163C5F22DADAD938375F1DCF389CD2C542A7875EE39191F1BBCF1A0F7DFFFC52F7FF0F6EBB30F9BBC937C6F6E6ECE65B301BF9F1B7F20E076B9164A972512896834DADBDBFBCB5FFE926955851425316E5FB6CC589E4AA5689692743AAD97AB342EE5C7DBD03C95CFB9FD014FB0D95DEF73BA3C0EC7C2E8FA6C3A918E45EDF3DDBFA85DD221974965E251467B3E6B8E32F2F1E5CDBE8178CAFEF892F23C1A0DFD7624FF8D9D4B2C4BA0FBC5175FECEFEF4797BDFFFEFB6FBDF516B3A20A9B7599786E6FFEE1E1176F3EEA4797BDF78BB3DF7EFBDB2F2C76FE76782A9F7F6EE155058CB1B4EAC01B0F2FFCEFF3976EBFFAC2FAA3BB36A83EF96C3D9DEF4E385E57E772BB31CA7C3E1F8A6C4174595B5B5B3E9F479DDDBE7D7BFDFAF51B376EB42687CD2D2D46446910ECE289845191192B94BBD7E5A70ECD3595874A1E6FC055EF73389D8E3A47B9A7E6AF3CD3D83695CB6753099B7CAF0F364920B399645DDD542E154F1914993AFC87362D1F893DED0DA76D8E2F5D9EEF0FC5BA26D3BBD72CB326816EA4E7D4A953131313D8F69F7EFAE9D1A34741864275946A59530AB72278FFF6AD53FF6264FCF1D3E14F3EFDF4C4B1A3EB9B1C0F42FF3FE015685DD6BEFDC0C0CDCFFFDBCF3FD9B96E456B63409120059CD2F91E8BC51A1A1A70351C0E07E63D9319370595E7FB2B00643299C1C1C15C2EF7C9279F6030060256F0922EA40E2D94C17776BBDDB2C49AFCA413314FA0716A2AEB703A5C1ECD28ABB95DE66D68C8E733B9B10166633B7C4717CF10672AE7F63A2D518616E0D7996D4B7FF655FFF0B0DDF1A5CBF3F95BFD9B562C5EDC18B42081C24EE6B123478E7073F5EAD5AEAEAE193CFFCEFFEBF5B8BEF3ADA3A0F1D595AB8F1E77AD6EAC6BF509D7F9B9FA334B65097CDB967D0D4B570E8F4FFEC79FFECA6C0B7A7D9DEF8CF6F1F1715CB06432891EB1A616F566ADDD04834142758B162D42D74C4E4EFEEA57D6F1B20640F153BAFC2031C9D0782A16C9409F4C360F88359722973748A8CED728823F76F83E0B39F6187FFC6FE9825F8B5A9A0FAE11F6AFFDF125E579329EFECB8B8FAC49A0EB873FFC21A034363622C72323233D3D3D5BB66C615A5B1069AE40D28B172FF2EB2BAFBCC2A73A6CCB16350E86A28FFA469E3CE9D9B67DCBF246CF407C2A67957915C0B3FCD3D0D702AF7FFA862A5E1F3C9DEEAAB17DF544CF9DDE81E18150E4D517D6495BC32C183ADF31C7A0AA34C7A4FD527BA34C020F2404B6701188D06FD8B0419DD7F2711C0B2311B0F2D0CEC8363E26E596E5672A979DC2C1747B30619C4EB7305885CD2A54416DFE043B1CA2B37C2E934FA7FA4626ACF1FDE7370625C060944B27B38928EE2A98A84BA024AFA47383D739128A4E24F3F6C79794E7D150743492D8DEB9985E4C49A053CC2EDA75E2C48975EBD6B1C4F3C1071FC856667E792EFE95E4939FA600FAD3374FECDDB62E118F9F3DFBB7F5AEBA175AEB1CB3B352CD27D6E2AE359418AE5C2A78E9F6A4BBDEBF72CF299EFEF0CB5B37BAFAB95179BCB88EE43B42130E8731851000C249121E49EDDA7C121961FAC46169696991EEE1AD5BB788DE025831CC154A54A0ADF078F14F527E1855192CB2E8643611CF419F6CBE8EF9B0464A4C681E16195CEE7A8FAFA13EB8C8E511EB8CD6F85E02668D6492E3C5E8972BD1F9F5FAF6F6E50D2EFBE34B97E76BDDA3F7FBC7CD4AA0EB073FF881CEFBCECECE478F1EE1F4E274702F71D07F5DD89B4B972E01809C51313E4D01F3D286CE4F6E3C1A181A411636AEE9C84C4D859204CB6A2886E5FB1ABE23F0FAFD3307F8847973E2F541EF2CD8ACA9E533E9F8F8E083BE9133FBB73BB5313F670BC51524DFD15F182F9863709F4B0FF99713E5EA9603153A4B5EDCCBA5465C04B28228A4AF62B04B961065330226720C348B8C4FEADB919F78329D4B271C6E8FC3ED72104694A918358B2542008C32B1D220BACC24C452AC05BEFFFCE6B4C59A67B93A9DA41DEC329A5297402A736191CDB0CBB1C437F570343E3611B639BE7479EE9B88EE5AD9EA764D2F101B195AEEDE29359FFC64D1EAD0A14340F9C5175F0C0C0C0028F7C60A0B782F8867159896A0EF0FFE9E86D7E79FF7F70F6D6C71347A1766115D6251FC29D9A342DE8267DB771CF4B7B4B1A0F11FFEE243CBFCD2F90E0004CBF0E918F6D2D92C2737552F072FE0C7B705186997D105A305FFC0145EE500937453A170711D5D7E683C151D276B21974A9196A19964050C99B7AF4C53E84E97D7EDF37B820DF58D22986881EFE5E093742BC6BD5C09EDE8FC6A5BD4BCA73348C917B6C79794E7E1C9C4CF2E3E302581AEEF7FFFFB46DC88B622C7CC844F9F3EDDB66D9BC7EDCE9B347F8CAD55F1FEF2E5CBB476E080B05CCC5A643CB27AE9A2BEF14857FF48EFD3A72F6CDBB624E8EE8FE0CB5511408B4D0DDF1178FDDEEBAA787D3813239BEECFE1082EE908F5DC7BD23F1C0CF8B7AD6E47F22C8022F93E3A3A8AF420D35E8F4718665865528B5868D1FC235AD0694A1BAF4E38934EA588708D8D8DB17CD9DEDEAEC8F4E1676364A0934A2663AC63A4524064537EBA0746C92375102CF378512AB3A918805B833F41D229CD24131921F96C867859CFE09829BEFFCD8D6109AA16234B6413316991A94BA0642C7436F2ABB9DE391C8A4D247376C7D78C3C8F4CC63CAEBA558B1B14257036462655329FC78E1DEBE8E820E7FBFCF9F3685D328CF49F16F046924F7E5A03E3BB6F1EDBBEB6633214FAF0DC850677DD965662A7CF4B8C4C1DA36298EB1B9A57EC3A0C657EF4FEE77D6393E81FF5D68C3525DFD12304CB42939338772258A62D621AABCDEB3D58A03D993E838140CBA24528534A3EFBEC3340C2E7B5D2B56651F0A0941CF969A59DA929293FD0272D8265A14C328A5F8F5D86CF52CC94792A71102C43837ADC1E7F437D430BA3138C4CF1DD009806B6D06AE2B246131ED4F9757A6BDB127F9DFDF1A5CBF3475FF70F86228A125842918112D91818F9F7EEDDBB73E78E9C95ADE159C5A7346A4F7F586EF68FFFC1115FBDE7FEBD7B376EDD5E1E74B60798D8588C5AC83FD3789582B6B9735373E786642AFDEECFCE33D2B8AC9148F29DC75934449111F8C79011CBE1B99CB506CD3E25A9E1D61C4CA1CB5A5A68017D7AEEDC396B7238BD8062A4B2D5410B24527E98DD93E171F2EC33C9782E9BCAB30C8E9B599B0B44842EF3B83C3EB73F281D4C9B7C37D2C62C1205FC3AB2B6C5EDA8B33FBEA43CA7B3F9BFBEDCA52881AEEF7DEF7BC5D09343C8CA11A9186C19D9B861432018449A455EFCC29930BFBD7205AAEDDFBF9F4F3C8E6298554A1AFC02AFABF77B709C59DA5FD9EA1F8CB100B59081FF917B02AF7F727A1F9FD2ADAB8CC8B93E2A967063482B0BF78B058DDEB1F0919D226B81AB7253C5BFEA7CE759888C11241232886AA3DB44B735316035F48432A6478DD72832B9A2BA69D326A1552BE2255C4B039C192DD81F8FC552DA16A56AC90F5D4021918AE1D236A84EFB3F25F8529259B60AE5C6027AA4159C8A5C2697490F4F4414F9FE8B5B04FB059C53792DFD025D9C114EB7BA044AB199A5B3D69CE497D7ED48A51383D19CFDF125E579221C1D8D26B72E6F9E53024B5B64C0BA75EB56768A204367DF7F1FD161E76C2953A076D68C26D5D31FC52350BDE49BFBB71EDC21F1FA5BA460671BEB40EA4F57BF66B5F02204D0F1F271FC8E8FAFDC618916FBC51AAC92EFC86522999C0C87A3A8804C06D66372A0EF6BF327A41607B3BE9EED9F6C02459942259C83870F1FA26A2BE35500A1AE5AAA4567293F4048FA552A1A4A9387954EE57379145B65C0AAF92BC840218F9794054FA099CD061458E53B049BBDD48134D2D9C8AFBDAB1777363A34BD616B7CE9F27CEBE9C4B59EB13925B092B81F3E7C78C9922504FE0952205ACCCEEA7856BDE62CB1C56C62EBFAD7DF3ABC66C592D191914F7FFD79B3D7B9BEC5458B0BF6A721C654C1A582550538FDCD6D6D9BF7D0DE7FFFC567A158CA72B04CF21D55485E59241CC69CC9A4090689B15AA1F7EAFE84B94180CC47665930D8D2DC0C65C00B3924AF15BD568150856048B91146F7EC55E171959FA4FCA04944B02C16C9261398AF4CE975FCE98A739E6F1C6251C4ED72FB44B02C281C70D053E1FB2C84521589E7C4A52E819244057436F2EBF886454DF575F6C7972ECFE76EF78522F1CA125849913112A429FED5575F7577772340CC938CB605F993E4969F2AD256A10E0B727FF0867051AF7D75ED7177D7DA6667ABCF6250A9422F8A3F55112F7A5CBC7E278B982313E1FFF27F2F580B2AD188CE77D83D110A6197C5E2715C33E9D4D586FB520FB055BB9E6C8CC646762FE15492AFCB02147258C1DE2C004F720173B28A74D6E5075D928A102C0B675331FC3B34BD22D3AB504DC34724C97A0996357A839CD29137C977A18BB4FF6769A30E58219D350753F2ABB9A9695F478046ED8F2F29CFE144E6AFAF76579640D777BFFBDD0AD0B3A38A39902570B975890312089D28DA0E159AB5F0D3B56BD7208D54AC6C61B1D082F191B6E6E05038D13D30461470EBE64DCB9BBCFD912C035563871C4435FA1C7D20F07AFBE45E3E55627F17FAE6002CD8D611EE7BF8747074281C3BB47DDD9C41252359F47B9DEFF09AC81DC1322EA91981B366179A425E0006718084C57456210896959343D2B98DE0F1884C88E586F2AACB8F46B12CFA448B9769812B11DB9B8347D5A9201231A6B41459DA63BD81FD06D9FED15065BE9FBD0D7D047822FD2293CCB2F6AA51465D02A59014D059D27C865D8E80DB311689875253F6C79794E7B1707C229EDADCDE441746FEEAF74291E95F4ADE70D61D8A8C0B1F93000AD28C0C95AC39AF85058ACC7E5FFB37AF7C3838D63B38363C3ABA73FB96064FDD40640176614A45F68F4F4D2BB239F13A2F82FD952E06150BF3E1FEC78FFB46766D5CB9B4A5015D56E98132BF49BE136527DE4115CC342EB8CF7D39612AD392AD62868DEC0E952AF74B2287AB56ADC2462B298705034C2A328EF7285064B660D21E96F23338162609835D901847E445D4A157A6075A4D74994483AEE8952947DB355999EFEFDD9E0EF68BCCFE54329B8A4B45A62E81B2CF023AEBF4D4F9D5EEAF1B984C84E2599BE34B97E7E170B27391BF25E0A5AF620974FDE99FFC89302F2BFE918E886645809896D9CE8248591B1B3AB6166EAE5FBFCE5372464DB201B822C08ABFEE58D3FE9B3B3D43C3A348E1A6D52BD83F174AE46A339BEABD8C3E1478BD7D52C4B60845CD09F90514D95C63846312C8964C84461E0E8C9E7E790B87F2087E99A798E43BFA02A3462A32A9CB1056A09533F37C7FD211522B0597BEC8084199228A6C5DE2270663015E43C3C346904A2AB2EACA4F2295CDA59278555A8A2CC466F9A87697C82CAB13CBCA6C21263E826202800A7CD72C3201DEF4A6F1640C8DC657750994042FA0B34E739AD2F9D5EAC97787D2E3A1B0CDF1A5CB339A71FB8A2682A7742750305C4E1942ABFC49CC75F7EEDD3CF9E5975FB2978D4D240893A1915ADCD2BBB8B4D158195AF55F9BFDF5BF77F2655ABD74F152FFE0F0A65677A317612870FFE7F7AB869519BCD4C05BB2F1255F536B57DFE87FFA3F1FB14A836CA99345AFA9F31DFD856986418452ABF11C2647057131C21A9CD581CF0B0028B2F3E7CE4DCBA1B60AA1C33C4DCF72FFCC8FFC30505391C90CFBC98994714E46ED164598D4509B6209D3E509102C73D70771322BF1BDC068D157414C52A61C818DFC6A5BD4F4E2326140D91F5F529E4723A9BFB9F6B4A404BAFECD3BEFCC35C10B0B004B1EFB9C8D78648870CE0F22CE0EE35A06CB6EDCBC0945F66979641CF8A902B34A9DCEC54D0393B12783E3BD4FFBB66DDDB2B4C9D33749B641393655BF7CECD10D1AFDB6669191FB3727CC1F89732E142E87C3DFDA8E83D933301A0CFAB6AE6A27C22462D1E84C337F92EFE4C74A9BAE5E3BA490694C181D9AE8D7E25374A5B1440476C419FC8C96B1F17154DB8A8E0E8866C46B8418990130DD2293D23F4FF2D33B3421B253308DDCF51CBDC82209CAC51CA14D71A5A0B2100752CAB43E73394EE247B3F50E4F94E4FBFBB7472460285C626499444C6C4E302381B2F3023A1B692EA099E157D0991B8B2426D37576C7D78C3C8F861364AB752E0A1448A009C38A7D6AF81AAC1C7DFCF1C718D2BE40A01696D84C1F5047BF66CAAAF3EF777EF7C096D5ED581CE73FFE24E8766E5DCA1C522029F3FA55A0C594A0382BA8C3E60D342CDD223CD65B5D62FF7FE5AC850AA4947C4779A132D29A4556A1F23CFD041658854436C8676612654EA584730D286427A64AA7D4D72F95FAEA75A4FC601411A2223DB56E4AF3766B2A42428B89201DE4F0D63BEB7D9C3206B225F95E4A7E0461D42550853234A8F36B5FBBA7C59BB33FBE7479EE1D8F17C3E0C626177898BF688B99D0FC73F69ED0A0B50C73B9BE8576171C061F31BB7395AB395FE55A8F2A784D4D9938B763068D697742A5FD0A084A5DCBDAAE58DE9D896957A85FC59FE008BDEBF91FB2654A187F825B06192E9049BE8A1A3A28F3293F9AEE92A4C6B79432A5773CCF37A0A83BB4B30E4529BEEBC4108F409819DA68E5464A5686B880CE05954BF24BEB4F7083ABA0BEE257F91883B458024D28B28B972F1320C3D760471E163BABE096015284BBB89A54BAEAE42E6EA1B8E4BFBE7FF9CE1381D7C92387E3E9DC9DA1A49089DA5ED31C320CC8B2FD2B0B01A7CD8CDCFD2DED6C5BD50EE309D85BA39BE43B5A03578E69560F8F9685701E7EC031E442EAC8BCE1225246279CEBCFF6B2682462C4AB4026C5A0D12E09D4FCC90F3010C673708496B08E849B59CB4BA86B463787C76692FCB9FD0DF45E9AEF0E7D099B1BE831AD534C48A0861844AD80A0915F978732A1B4CBFEF8D2E5B9A32568E4A904C35D59B3EAB0F6F5F777757521C7A74F9F669B08E93CC0AAFF5AE31B459855A0BAF8A0FFF3DB5D8CCED74F1F737BDC977A6244B3551EAC721D4D2C54F0AA283FB34021D983373F67ED92FD58DF3CB08D736CACF14BF25D4A2D8A4C24456BB698B0866A75D13BDD9105C2DCC91953329C4C2AD98E1D3B4232786780A4003029F1127EBD960A9DF5CA956FA4FC4875C08621B2C9047D847954699C576ED3F4AF1A7D5867C0A34C25C2E851AE727CD701D3280394337C549640095E019D8D301BF9757728DC1713992936C7972ECF1B9606F7AC122F0A28004049913107CA34AEBD7BF72E5BB60C79E2AC2823E835BEAF96204EC6533FFD58E4A3EEDDFBF2F2B6B6AF8793E184588AAEFD25A55E092FB50132F6F07A3232C14EAC3FFED661B1DAA8253D9AC54BE73BA610E9DABCFE920376104ACD2531DB98C5FA52139198C261CAA8313227D8F6CBBBE38E1F3F8E1CCAADE0CF34FDACA69F36D69E2D54A2F3338D96FEA2CBCF5436CBE9A62EDE17E7F2B27368C6CA29FD54954B2581B219764AA5E3D17C32C55EC24A7CD7E5871BFE743DA681658232CF925447CAC8AFB150E4D6286681C3FEF892F2BCB8C1FBC6B6652525509CF1A40351EEE6CA952B8457C9207B79F76E5418D37BB99AF35D2EA155815905923FFFF0CAD864ACA373C5DEDDBB86A399EEB1E4DCB45069D77C1D75BC54BC5E0EBF0EF53C000A766291768153691E22F184E47B3693E185977873A43B106E974D558B057302C6C48B1A45170B632C1A458BF1C8ABAFBE4A218AACF8F102C0C457B94B54ABAA4EE7E2968B4BA4FCA0C59C5EBFDB17E4681D962DA926A4486158153768A144586322B5952312C5C64FB4188D54E0BB4E1F7103A033709AA58CDE4E01CC467E7DD99F48649DF6C7972ECFC7362EF17905825C0500CC7D002CB618EF80C0AD3879F22450E2544ECF72B2BD85F8241FD77EB7FFE3DCB51B8F045EA78F1D496672D7FB638419EC376BB105CD5353C16BCE603FA7B20CDF11A1B1A3BB376FED6C8B4C4E9A98660DD04BBEC371FC14CE9E468B1158107E53910C191EAAF22DC28AC24211338F72D62300D0010717E316B027B924B90AE49BAFA02F2860589D28F9A059D0A5FC88B1E074B0A0E6F2FAC459FE62D3D0AC7630DBA6E9FA428D89745C0E7A4D4527EBC4D68239F8AED3871B794D77AA2C81B23ECF16434BA1CEAF5F3F890C279CF6C7972ECF5BDA83AB5A03E524700E8B8CC4B1AEEE6E20C692679D7B627C1C408B11A8714949229A82E1DEC0F86F6E77F3C8F1A3AF0603BE4BBD1C565305E5680A066365A94195F02A2540C6A646EE5C263FE8A5CD2BFFE81BAF60B388F51DF397CE77CC314E37441C098C12E6A7252520CDF758FC041D11D7230597C431AC3194119BC5D7AE5D7BF4E8D171ED48EEE2478AC1A31171E1DE186A6B0586EFE66F75F9114E65538B8BE89807A752EB642E0699EFADCC134241E7F2E90CD9FC6C5CC7F0C41C9B9BEF3A78C4C7B8E74F03DB84046AE014D390129D5FDD2391DE989016FBE34BCAF3AA45BE335BC54BC869B3B86B0A2B2932262E9986BA6BD7AED5AB57332AE466370D9105FAD0D8501213758032D9DC4F3F11E9B53B5FD8BE7655E7A3D1D448446C275CC84B19AFCAB84F3E7D109F185EDCDCF047DF38842123B7499AC54BE73B61043C4A2630B2B72AC890D9F655EA8326C6205A0C5B0C8F9214686060E5EBE8912351F6189477960BE8C3575132335CC54D9991A00295ACA3CB0FBB2CDD81A0A73EC0F656F2C8F0D4C47FB5B98495390581387883D384702DC92053E1BBA0867609BA886BC654354919F1A4E1E2ABCEAFC948F4FA98088DD91F5F529E1BEA5DA7362FA92C819514D9D56BD7702439928C1D8E0C09EE0D902FCCAD245E0111CD82F2E7E7AEF50E87162F597CE8C09E503C777F385633F12B07AA09BC9E15206383A9C8C444F71D4A7EFFF57D01AFD85464FC55FD5EF21DD39B0C540E07E6201D322D8150FC95EF5DBD7D959A8C0AA6771416273B628E610FF2142F73C3BBE4FC820A2D082FD270F155FE09A74B43417C3E5B47FBC5C487941F361970F89FC7172401D5E1C1A994569F15FBD744DF335545C22314CA267975008B952E8D3E6A7C9F815038C1F24F0B17682DAB53A690CE067E7DD19708A75DF6C7972ECFAFAC6DE16CE76970CBF0AE6C1ED993274FFAFAFA10A053A74EA10BD9ECAE8EE40CB5E7EB5F1198B07A9DBFF5E4CA833E8FD773E6F86B18D75FF58639DDD36A63D57B4E638F0A5E1C0651B25742E223F7AF306C0FEF5A7F7073A7E550A6E43BBC4695E054628E49A752CE8725BBAE7AA1D462AC99E201A0C55861C06B63631C7EA5786DA50DEE4B50EDB420E507FAD088B7B14938954EC2CFB50F8DE154A6D88D948E46C8E9070045BEEBA318F8B5FB19E15796C062761BF9756B30369870D91F5FBA3C6F5C1AD8DADE84F85596C0D2E9178978E2CEBD7B40CCF210D2CC1C88915F8CC0429514CC06EA608C44E23FFF52E075F895BD8B9A9BAEF64562CF075E529AD4F02A1DCB1B7B7C9D7D735B572FFF577FFF559C2F6BA14C9DEF28117668A3C550220890366CAD4F1EEA0CA2267D71216F68318C4AEC329C4A5EEBC54B9EC64647C50121152F0695F177BECA069F292C33AB1BEB94BCD7E5279F4979828D1E5F40248EB9C569E925EBCF4BA1860F1982D934F916614EB170B8EBCDF05D07951BF927C094A56A1228EAEB7496E495FC1A1C0FDF9F14612CFBE34BCA737B93F7D4A6C52A1258DAB5BC7EF30690F17A8ECD9B3713A428B9CE2DB0A9FD25E70DAB82F83F3FBAC976C1F5EBD66ED9B4B12794EC0B59CC4BA83EDECA7895443D36DC171BE9ABF77AFEF01B078419533E84541972C977B418BA4386C6506448AA588C2BD971E5E6CCFF2A7B218E01123226CB3A0359B86C26C1C35491C30238F92AAF695894E95C1276293FACA3119072D70778AD00DEA550BD389635A18FF48A89CDE55209F1BA8064822C5C537C075889DA345D740BDF2465643BF253E7D7D5917C76CA697F7C4979668238BEA15551024B283202FC9860722B12EA8C97B6EAC897E46E2D0B2513ACC1F3A38F6E3EE803AF86E3AFBE124B656FF747F56CC05AA250B22F1378E50B5DCB4C2A36DE7D9B66FFD1F1979636FA39A9C21A7D24DFA52927B3C67463DE5A832531AD5C48470080264567618E91F3417D42B468D5FEBE3E15300AEAF0D5586282CE45804AF961658EA3BF3829DFEDF5E3D371089888964F2B87A267AA5D20F653E6B228B24C32968D46C8F9A007737CD7419DA6C53488662923A9CAA7CEAF2FFA9213622B92DDF1A5CBF3DE958D2D81D25963C5742546A663267E1D1A1E22344648F5C48913CC846490E93664F1C30B555200B30A1857BB862EDFEF63649E3AF61AEF37BDFA783CC3398ACFCFA539442A78198725E013AA19BD7F8D80C2FE6D6B7FE7E54D9313136CB9B38096E43B8D33BBF2E2226907C9BCAD821E2D34AEF8081DE148028058A99C098DE116F066F8FEC14145BC0AA0E5ABBC8C30A8D0D9589F7B293F909B9D4024F173523E2F8293EFC715EF1CA9CD85D144BE45369D4DC632D1082B3058CAA6F9AE432B5A33ACB22A4BA0C4555255E7D7C391D8404244216C8E2F5D9ED7B6D6BFD8D9A42E81C4C866E51E19BAAB85C6F6ECD943CEE1F8D8583AB9905B91CA898711E672758CE59164FAAF2E8AD0D89EDDBB962D59F2F5606432F61C85FC004CF24009AF67474DA8F75E3A36B9BABDF53BDF14596325B6EC180951E65EE73B1B80B07D48B8F0F23ACB9AB94B1A54626090DCC969B48984DC198A3265C59CACB1B1890971A6ABE2A5B948B375F9CA107DB65089CEB34DD4E9F243EAA9C7E727DFC2E9165963F8DB865AF37C2B09C45B2C5309B64FF3564A67BDDF0ADF7598B91106DE340A2624504354AC15CCF08BB74FDE8B886561FBE34BCAF3A280FBD8BA165312F88C6B79FBEBAF894D10587DE9A597D8DAF63CE45B144A879C3766A85FF86B99EF3FF9F4EB894862C58AE52FEFDA3E144D3E1E89D55000CBC05450AC6184AC1614177F35CCA175C9C9D1C8403775FED9A93D53D98CE5AD6392EFA833F22D702AC9B7E0A68EE44399A75E0CC43C948039DBF539F28C7C0B627CE8533A3974E81050B1335CBDC3020AF295213A5B68437E70E8C40BD8FC41721D1CEC31C0A1D4D233D561B35313358FF2CAA693E98478019DDB2FE86381EF9C872DC190F6D8AC38294BE0CCE3B3FCBA3A3AC55624FBE34B97E743AB9BEAEB3DA624705691DDB97B97138499064F1C3B86DFFB5CE55BE81220E70D9501AF3FF293CFEEDEEE19F1F97D278F1C4A66F2D77BC3A61ED7DB99D71B295C4A80CD28BB5C363DDE254263AFBDB86153C76256F4941E2F4243F25D646D65B322899F0D9518F4981BD49CE9ABE8A1EA17608B917FCB3B34D953C952031D906FC1E6F0A73DBDE6F02A80597E9D29B42C3F581F9088B7BA88D0184E25C7E4F3279BAB3E314AB488D78D26CD26E29978CCA5D1C722DF759891B959053F7DAB4E6A9D5F970752A329B7FDF1A5CBF3C6365F678BCFAC044E2B328C2F4263D00F4B9EA35F07070608F39720E7F351A44EEE4743A14BF7055EC70E1F08FAEB2F764DA4D20BBFC5AA0415B591A684D7CC981C7F7433974EBDB8B1E30FDFD8577C9A4D892E4A15E97CC7126F6C6890A13119E367E8967A62BECAB0BCC456A468541C73EA72AD59B3E6B5D75E1BE8EBCB64CDC96101D882A4FC3F4334097DC1D70A28E9F28343E70934305ED906244EB2166ABEA6F4992234968A671284C69C2C32D8E0BB0EF6F4EC398DBEBA046A0F487EF54CC4FA12221E6F7F7C4979EE6CF2E0545A904011ECE740B6070F1F02CDCE9D3B790918A38268EB347ACFE53F8AC1DA4C3EF79717055E3BB66F59D3D9F1603836BCE05B91CAD0735AA6F4406C996A14CB9A91C1EE64787C7173F09FBF71008F3299B09247A2F31D0D823BE9672B92B6A19271AE0B7B7940AAFC0B5130627CCCF3EC2560C51C2DC6F26B2C1637DB4D4126147AAD508D4143053AD3AF2E3F6203503DEFC1D59C4A6D63B6C194310BA0C5FA994C2A9D106F3C72FB0276F86E84BCF85E9132E000BFC291E89D49111AB33FBEA43C07BD8E23EB44EEAB050914A78EDCBB778FA56E02ABFBF6ED63E59B0DC31689FD9C3DF693DFDCEB1F0B2F5EDC7A70CF4BA178E6FE60C4684B3F67C02A83C3C2626C32DCF78807DE3EBE3BE8718C8D46941F7EA6A2E43B0E1DD6774380B3B45CD96A1C2BF24C1FCA5FC486CA582CD8D8C813E45B60F1B0D6A4FCF46C45D099FD52572770E33D03B8177EBFB15CE55ECA0F0E1D0B85648DE14EE2DFD54DA58DE35FA59DAAD4C9F03EF34494B40F5AB3C3F77C7A7ACEC395D350CBC81C0EB340C2AF2BA3F948C6637F7CE9F2BCBBDDE77110EC3567834BC8DD7DFD7D834343645A70BE05456C01515CE7368B7975EA6B06B0CAAAD3AFEFF55F7F3CE4717B4E1D39C8047CB567A260AEAE0E3CD56A45192F76D89135C6947568C7BAFD9B3AC4693696EC27DEDC01DF89FC902748809F9317D998ED4AA5A4555F2DB4D4DBE1A536C1860642739B376DE284829E274F88DAA93FAED70C479E51EB68B1583CCEEA41435393A8A34C67293F187489C9518F9F77AC11688FE773C4F84584BFF617A39D7D9D2CBFD8E43B6B051278B137201163F5C0131093873A65E4E3774692C3290EDAB43BBE20AC94E7CE607E8927C3712DD624D0CD314F4076F0E04102BD68315CDF674E3C9150FF1DFCEC1A125BA60F1D78B985AD483DA168D2CAA8780EF19E78729F45AB2DAB967DE777F713E192F9AB16E0947CE7E57E0C75C25268794F32694D862CF45EFC88784592DBCD31FC24F1A361851C5ABA784D9CF139B0C3C92054D2662C55B897F2131D798A3747BE183E97339514475C2CD0E570BAD945609FEFC9D0347D38E09F182B89B5FE16B3B4112408E74568CCFEF892F2DCE84AAF71C542210E6AB248E1FF07EF66278C289EA0EC0000000049454E44AE426082"
		    Dim ImagesBlock As New MemoryBlock(15349)
		    ImagesBlock.LittleEndian = True
		    ImagesBlock.StringValue(0,ImagesBlock.Size) = DecodeHex(ImagesBinary)
		    Images.Value("8390698C7A66FF203FDF08EE04A9ECC8") = Picture.FromData(ImagesBlock.StringValue(0,4678))
		    Images.Value("A078C85FD338875A9247873EC64626D6") = Picture.FromData(ImagesBlock.StringValue(4678,10671))
		  End If
		  
		  Dim Key As String = EncodeHex(MD5(ImageNamed))
		  If Images.HasKey(Key) Then
		    Return Images.Value(Key)
		  Else
		    Dim Err As New KeyNotFoundException
		    Err.Message = "Could not find image " + ImageNamed + ". Image names are case sensitive."
		    Raise Err
		  End If
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function GetSpriteSheet(ScalingFactor As Double) As Picture
		  Dim SheetWidth As Integer = Self.SpriteWidth * 17
		  Dim SheetHeight As Integer = Self.SpriteHeight * 1
		  
		  Dim Sheet As New Picture(SheetWidth * ScalingFactor, SheetHeight * ScalingFactor, 32)
		  Dim Source As Picture
		  If ScalingFactor > 1 Then
		    Source = Self.GetImage("Breadcrumbs@2x.png")
		  Else
		    Source = Self.GetImage("Breadcrumbs.png")
		  End If
		  Sheet.Graphics.DrawPicture(Source,0,0,Sheet.Width,Sheet.Height,0,0,Source.Width,Source.Height)
		  Sheet.HorizontalResolution = Sheet.HorizontalResolution * ScalingFactor
		  Sheet.VerticalResolution = Sheet.VerticalResolution * ScalingFactor
		  RaiseEvent Paint(Sheet.Graphics,ScalingFactor)
		  Return Sheet
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function GrabSprite(Source As Picture, ScalingFactor As Double, Bounds As REALbasic.Rect) As Picture
		  Dim Sprite As New Picture(SpriteWidth * ScalingFactor, SpriteHeight * ScalingFactor, 32)
		  Sprite.Graphics.DrawPicture(Source, 0, 0, Sprite.Width, Sprite.Height, Bounds.Left * ScalingFactor, Bounds.Top * ScalingFactor, Bounds.Width * ScalingFactor, Bounds.Height * ScalingFactor)
		  Return Sprite
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub HoldTimerAction(Sender As Timer)
		  #pragma Unused Sender
		  
		  If CellHold(Self.mMouseDownIndex) Then
		    Self.mMouseDown = False
		    Self.mMouseDownPoint = Nil
		    Self.Invalidate
		  End If
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub InsertCells(Index As Integer, ParamArray Cells() As String)
		  For Each Cell As String In Cells
		    Self.mCells.Insert(Index,Cell)
		    Self.mCellIcons.Insert(Index,Nil)
		    Self.mCellIconTypes.Insert(Index,IconTypeFullColor)
		    If Self.mValue >= Index Then
		      Self.mValue = Self.mValue + 1
		    End If
		    Index = Index + 1
		  Next
		  Self.Invalidate
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub InvalidateSprites()
		  Self.mSprites = Nil
		  Self.Invalidate
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function Registered() As Boolean
		  #if DebugBuild
		    Return True
		  #else
		    Return False // Invoice: XXXXXXXXXXXXXXXXXXX
		  #endif
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub RemoveCells(Index As Integer, Count As Integer = 1)
		  Count = Min(Count,UBound(Self.mCells) - (Index - 1))
		  For I As Integer = 1 To Count
		    Self.mCells.Remove(Index)
		    Self.mCellIcons.Remove(Index)
		    Self.mCellIconTypes.Remove(Index)
		    If Self.mValue >= Index Then
		      Self.mValue = Self.mValue - 1
		    End If
		  Next
		  Self.Invalidate
		End Sub
	#tag EndMethod


	#tag Hook, Flags = &h0
		Event CellHold(CellIndex As Integer) As Boolean
	#tag EndHook

	#tag Hook, Flags = &h0
		Event Change()
	#tag EndHook

	#tag Hook, Flags = &h0
		Event Open()
	#tag EndHook

	#tag Hook, Flags = &h0
		Event Paint(G As Graphics, ScalingFactor As Double)
	#tag EndHook


	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mAlternateTextColor
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Self.mAlternateTextColor = Value
			  Self.Invalidate
			End Set
		#tag EndSetter
		AlternateTextColor As Color
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mAlternateTextShadowColor
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Self.mAlternateTextShadowColor = Value
			  Self.Invalidate
			End Set
		#tag EndSetter
		AlternateTextShadowColor As Color
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mBorderColor
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Self.mBorderColor = Value
			  Self.Invalidate
			End Set
		#tag EndSetter
		BorderColor As Color
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mBorderPosition
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  If Value >= BorderNone And Value <= BorderTop Then
			    Self.mBorderPosition = Value
			    Self.Invalidate
			  End If
			End Set
		#tag EndSetter
		BorderPosition As Integer
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return UBound(Self.mCells) + 1
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Redim Self.mCells(Value - 1)
			  Redim Self.mCellIcons(Value - 1)
			  Redim Self.mCellIconTypes(Value - 1)
			  Self.Invalidate
			End Set
		#tag EndSetter
		CellCount As Integer
	#tag EndComputedProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mAlternateTextColor As Color
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mAlternateTextShadowColor As Color
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mBorderColor As Color
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mBorderPosition As Integer
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mCellIcons() As ArtisanKit.RetinaPicture
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mCellIconTypes() As Integer
	#tag EndProperty

	#tag Property, Flags = &h0
		mCellRects() As REALbasic.Rect
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mCells() As String
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mHoldTimer As Timer
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mMouseDown As Boolean
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mMouseDownIndex As Integer
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mMouseDownPoint As REALbasic.Point
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mPrimaryTextColor As Color
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mPrimaryTextShadowColor As Color
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mSprites As Dictionary
	#tag EndProperty

	#tag Property, Flags = &h21
		Attributes( Hidden ) Private mValue As Integer
	#tag EndProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mPrimaryTextColor
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Self.mPrimaryTextColor = Value
			  Self.Invalidate
			End Set
		#tag EndSetter
		PrimaryTextColor As Color
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mPrimaryTextShadowColor
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Self.mPrimaryTextShadowColor = Value
			  Self.Invalidate
			End Set
		#tag EndSetter
		PrimaryTextShadowColor As Color
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mValue
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Value = Max(Min(Value,Self.CellCount - 1),0)
			  If Value <> Self.mValue Then
			    Self.mValue = Value
			    RaiseEvent Change()
			    Self.Invalidate
			  End If
			End Set
		#tag EndSetter
		Value As Integer
	#tag EndComputedProperty


	#tag Constant, Name = BorderBottom, Type = Double, Dynamic = False, Default = \"1", Scope = Public
	#tag EndConstant

	#tag Constant, Name = BorderNone, Type = Double, Dynamic = False, Default = \"0", Scope = Public
	#tag EndConstant

	#tag Constant, Name = BorderTop, Type = Double, Dynamic = False, Default = \"2", Scope = Public
	#tag EndConstant

	#tag Constant, Name = IconHeight, Type = Double, Dynamic = False, Default = \"16", Scope = Public
	#tag EndConstant

	#tag Constant, Name = IconTypeFullColor, Type = Double, Dynamic = False, Default = \"0", Scope = Public
	#tag EndConstant

	#tag Constant, Name = IconTypeTemplate, Type = Double, Dynamic = False, Default = \"1", Scope = Public
	#tag EndConstant

	#tag Constant, Name = IconWidth, Type = Double, Dynamic = False, Default = \"16", Scope = Public
	#tag EndConstant

	#tag Constant, Name = SpriteHeight, Type = Double, Dynamic = False, Default = \"22", Scope = Protected
	#tag EndConstant

	#tag Constant, Name = SpriteWidth, Type = Double, Dynamic = False, Default = \"12", Scope = Protected
	#tag EndConstant


	#tag ViewBehavior
		#tag ViewProperty
			Name="AlternateTextColor"
			Visible=true
			Group="Behavior"
			InitialValue="&c000000"
			Type="Color"
		#tag EndViewProperty
		#tag ViewProperty
			Name="AlternateTextShadowColor"
			Visible=true
			Group="Behavior"
			InitialValue="&cFFFFFF"
			Type="Color"
		#tag EndViewProperty
		#tag ViewProperty
			Name="BorderColor"
			Visible=true
			Group="Behavior"
			InitialValue="&c9e9e9e"
			Type="Color"
		#tag EndViewProperty
		#tag ViewProperty
			Name="BorderPosition"
			Visible=true
			Group="Behavior"
			InitialValue="1"
			Type="Integer"
			EditorType="Enum"
			#tag EnumValues
				"0 - None"
				"1 - Bottom"
				"2 - Top"
			#tag EndEnumValues
		#tag EndViewProperty
		#tag ViewProperty
			Name="CellCount"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Index"
			Visible=true
			Group="ID"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Left"
			Visible=true
			Group="Position"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Name"
			Visible=true
			Group="ID"
			Type="String"
		#tag EndViewProperty
		#tag ViewProperty
			Name="PrimaryTextColor"
			Visible=true
			Group="Behavior"
			InitialValue="&cFFFFFF"
			Type="Color"
		#tag EndViewProperty
		#tag ViewProperty
			Name="PrimaryTextShadowColor"
			Visible=true
			Group="Behavior"
			InitialValue="&c2d4959"
			Type="Color"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Super"
			Visible=true
			Group="ID"
			Type="String"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Top"
			Visible=true
			Group="Position"
			Type="Integer"
		#tag EndViewProperty
		#tag ViewProperty
			Name="Value"
			Group="Behavior"
			Type="Integer"
		#tag EndViewProperty
	#tag EndViewBehavior
End Class
#tag EndClass
